# Shunsuke-Torus/RSA_Variable

1. 概要  
    - RSA暗号とディジタル署名をpythonで作ってみよう  

2. このプログラムに求めるもの      
    - RSA暗号に対応  
    - ディジタル署名に対応  
    - ASC2にも対応  
    - ランダムで入力できるように対応   
    - 自分でも入力できるように対応   

3. 必要なモジュール・ライブラリ   
    - モジュール  
      - utils_rsa2  
      - utils_insert  
    - ライブラリ  
      - importlib  
      - sympy  
    
4. 注目ポイント  
  文字から数字、数字から文字の時において、制御文字を回避するために(0~31)の計32文字を引いたり最後に足したりした。  
  
   数字から文字の際、最後の最小正剰余を文字に戻すことができなかったため、  
   ifの文を使い 数字//95<95とすることによって、ほぼ全ての数字を文字に表すことができました。    
  
　　平文を暗号化すると暗号文から平文に戻すといった流れがあるため   
    　　以前の平文と暗号文をそれぞれ記憶しておく必要がある。  
　　以前の状態を記憶することにより文を入力せずとも計算できるようにした事。  

5. 反省点  
  ➀ utils_insert()では数字から文字の際、if文を付けることによって最後の最小正剰余の追加を可能にしたが形が不細工である      
  　ため次はもっときれいなプログラムを書きたいと考える。  
  　特に、shogo-ppt/rsaのencryptの部分は私から見るときれいなプログラムだなと感じたので参考にしていきたいと考える。  
  
   ➁ main()では、プログラムの見やすさを追求した理由から余計な引数が増えた。  
  
   ➂ sympy.gcdex()はinteger型とは知らなかった。  
    　utils_rsa2ではsympy.gcdex(e,L)を用いて一次不定方程式を書いた。  
    　当時はinteger型とは知らずにint型だと思っていた。  
    　しかし、TypeError: unsupported operand type(s) for pow(): 'int', 'Integer', 'int'  
    　と表示され間違っていることは分かったが周辺のプログラムは全てint型だったため気づくことができなかった。  
    　↓<br>
   ➃ 関数が他の関数を呼び出しているためエラー箇所が分からなかった。  
    　エラーメッセージが表示された場所はdencryptの部分で生じている。  
    　一方で元々の原因はsecret_key(e,L)を作る際にsympyを使用しているため問題のある箇所を把握するのが難しかった。  
    　対応策として、次のプログラムを作る際はそれぞれの型の特徴を知っておくことや  
    　関数の接続先に目印となるものを付けることによって、エラーが発生したとしても対応できるようにすればいいと考える。  
  
6. 最近新しく学んでいる事  
    - web認証  
        - ストレッチング  
        - hash  
    - 共通鍵暗号方式  
    - 他の人のプログラムを自分風にいじる  
  　  など勉強しています。  
    - 資格系    
  　  また、4月に落ちた基本情報技術者試験を10月にまた受ける予定です。  
7. 参考文献   
    - [【備忘録】Python3でのreload,Hisasi SATO,2015/12/11,2021/07/29アクセス](https://qiita.com/mriho/items/52f53559ba7fe7ef06ff)  
    - [公開鍵暗号と電子署名の基礎知識,Kunihiko Ohnaka,2018/10/29,2021/07/29アクセス](https://qiita.com/kunichiko/items/ef5efdb41611d6cf7775)  
    - [リポジトリを作成する,GitHub Docs,2021/07/29アクセス](https://docs.github.com/ja/github/getting-started-with-github/quickstart/create-a-repo)  
    - [ASCIIコード表,Wakaba Programming School,2021/07/29アクセス](https://www.k-cube.co.jp/wakaba/server/ascii_code.html)  
    - [一次不定方程式,ictsr4,2020/09/28,2021/07/29アクセス](http://ictsr4.com/sw/gcdex/)  
    - [RSA 公開鍵暗号方式の実現,浦上浩一,UNISYS TECHNOLOGY REVIEW 第 64 号, FEB. 2000,2021/07/29アクセス ](https://www.unisys.co.jp/tec_info/tr64/6403.pdf)
    
8.プログラムの実行<br>
    RSA

    pを持っているなら入力:0,持っていない:1 
    p:1

    qを持っているなら入力:0,持っていない:1 
    q:1

    eを持っているなら入力:0,持っていない:1 
    e:1

    公開鍵:1,秘密鍵:2,暗号化:3,復号化:4, 
    ディジタル署名を生成する　秘密鍵:5,
    ディジタル署名を確認する　公開鍵:6,終了:7 
    input:1
    公開鍵n:  
    146326250272588524237223073551818379380488987967693825997318955391097067801702307374092926496359335064341570735499506537475574079700518613353202576608212577518259738187321086257906427217831355915820967701274990723861616019934555002017674468026765474764401049685837324206577512358992523464629809836763637113221112660746299631996723179826461039687794288655634524493193316065428833384371205455278679888216349278454667194985245760496470355789394410420273740755537072183623096045567431367659622674205643225580124795534408007004556957636405256764509459876276557639504570053642679647995525794807373269137761
    公開鍵e: 
    7475494969786825065509646464393609623051380998947275092144265115960777766857596994127322965150783796504125571369863299179534576042924204569083289520345795399258657355612079600381937028950711686750975920785485316170153203739611445172790137223940701409889386078033725278042240737860315528188351648330901018055365398196421325470474832855519799099169579216290801696107788973434417721129402277361137640632524870184958792250790143640952896674248933350439798393855618943822870191728810212490690160537969201510051660370991952500612224960112118352653386551825959968858413585874142731321303075442504546681299

    公開鍵:1,秘密鍵:2,暗号化:3,復号化:4, 
    ディジタル署名を生成する　秘密鍵:5,
    ディジタル署名を確認する　公開鍵:6,終了:7 
    input:2
    公開鍵n:  
    146326250272588524237223073551818379380488987967693825997318955391097067801702307374092926496359335064341570735499506537475574079700518613353202576608212577518259738187321086257906427217831355915820967701274990723861616019934555002017674468026765474764401049685837324206577512358992523464629809836763637113221112660746299631996723179826461039687794288655634524493193316065428833384371205455278679888216349278454667194985245760496470355789394410420273740755537072183623096045567431367659622674205643225580124795534408007004556957636405256764509459876276557639504570053642679647995525794807373269137761  
    公開鍵e:
    7475494969786825065509646464393609623051380998947275092144265115960777766857596994127322965150783796504125571369863299179534576042924204569083289520345795399258657355612079600381937028950711686750975920785485316170153203739611445172790137223940701409889386078033725278042240737860315528188351648330901018055365398196421325470474832855519799099169579216290801696107788973434417721129402277361137640632524870184958792250790143640952896674248933350439798393855618943822870191728810212490690160537969201510051660370991952500612224960112118352653386551825959968858413585874142731321303075442504546681299
    秘密鍵p:
    868803635645076677562631203050264040418169958616800106333938792905915669703815644066941926861920584985800855881798290515017089152321293334133023845672208713477418120304646855724473858708105156558230871934326216617140174921495984042659630565289459570565185926643244605991980424264605241755633302229151
    秘密鍵q:
    168422695611699381674301685265654192144912946018308117957044584504190582664193476408970144071205146589897949703768861981443569798535985662193395118617723744744428504664317781868126711818794629943342737996729397939731465955964596453816429080050964701537697399221230992323052867441504776879695653402111
    秘密鍵L:
    14632625027258852423722307355181837938048898796769382599731895539109706780170230737409292649635933506434157073549950653747557407970051861335320257660821257751825973818732108625790642721783135591582096770127499072386161601993455500201767446802676547476440104968583732420657751235899252346462980983676259988688985588468706269910840726159389795678315918043134354111578320981306082426389529338434555415664065047286910004248878510154561307679306799145598380829731522555865413140797483079713272288770406961564906918097753636612709637713992919711916903560417367431364009445532764635628941577617204431350650
    秘密鍵d:
    8553949355050723450658791525794107283268142563474488454531210459009181941271874980172773230077946416460055897636847422999224636191854305319652692649250607155131424620845557712235955640293934618012224720246865979582307247811395750240799354749202473227755849950364311527493607733333139010808431128900042438087851559514728232786591561418484745470449034623605962185542620720578457971789395137916211308872108924955283572104734391185572353544613356886814422176830364326080615571328807212687619228814118705877032949201456699595556956387243317537172187170973208945445658736974313136817921368162333646500699

    公開鍵:1,秘密鍵:2,暗号化:3,復号化:4, 
    ディジタル署名を生成する　秘密鍵:5,
    ディジタル署名を確認する　公開鍵:6,終了:7 
    input:3

    以前の平文を利用するなら:0を入力してください。以外なら:1 
    P:1

    文字列を入力　95種類　大文字　小文字　数字 etc 
    abcde12345XYZ
    暗号文: Y:X5S;.NuY=53wb0>\PL;c}G*e$j3bF%IVh`6iKE>O~u 8PT E(l%x'ZBO31=9ylXWWgM!bM-653ZqDuVh\K#AmOiU!,taryi|9az8|2k6~!KN| "AHK$kvt'b<Cq!b`=HC7pU y}xaR#H[19kq>g>'fMw"v>rAv56:4=XB&l`Mh6R(WkriWz$}6gJHhv^s/3ht<,.pT6se) ?7>O-),[+JYlzf9'4TF|5$-J?,&tXzHcZ+^Ps(K@X<6a}zb!"paod{yG7_h5>t$DiG&op)CO7OzilozLN[NWd'L`AA)qR!iH@#

    公開鍵:1,秘密鍵:2,暗号化:3,復号化:4, 
      ディジタル署名を生成する　秘密鍵:5,
     ディジタル署名を確認する　公開鍵:6,終了:7 
     input:4

    以前の暗号を利用するなら:0を入力してください。以外なら:1 
     C:0
    P平文: abcde12345XYZ

    公開鍵:1,秘密鍵:2,暗号化:3,復号化:4, 
      ディジタル署名を生成する　秘密鍵:5,
     ディジタル署名を確認する　公開鍵:6,終了:7 
     input:5

    以前の平文を利用するなら:0を入力してください。以外なら:1 
     P:0
    ディジタル署名作成: ?.,& !4h.ckPRbp_]B51Dg9S2j1wg5CozD^ZC >C$`_^@O-qL/nq[.[.K|w5-D{qFq!YR(C?P!q4?La-$Q]S~_1Sd&W:,{GiX!EXR)L6Ty~~KRU'<Db!K}*P\*h#\Dn(%W(HH`6cWX$JMm{jj3u@`X[pGSZ,A,-Q/n?l:i^N@lZ$n$II/F0G3mg(W[N*Af\hLlyH%A]Ulh8;J|bhx3Oj^MdpJAH/F/viR@>Kr@%7>Ac92K_$qdRDp'Xp=NaOVDaV"AoCEB|TgdxKm-(M4P#,ngQWU34&9'YPo8$;bJVebctv>]_

    公開鍵:1,秘密鍵:2,暗号化:3,復号化:4, 
      ディジタル署名を生成する　秘密鍵:5,
     ディジタル署名を確認する　公開鍵:6,終了:7 
     input:6

    以前の暗号を利用するなら:0を入力してください。以外なら:1 
     C:0
    ディジタル署名確認: abcde12345XYZ

    公開鍵:1,秘密鍵:2,暗号化:3,復号化:4, 
      ディジタル署名を生成する　秘密鍵:5,
     ディジタル署名を確認する　公開鍵:6,終了:7 
     input:7
